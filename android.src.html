<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>install.cat - Downloading APK...</title>
  <meta name="theme-color" content="#0d1117" media="(prefers-color-scheme: dark)">
  <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üê±</text></svg>">
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --bg: #ffffff;
      --bg-secondary: #f6f8fa;
      --text: #1f2328;
      --text-secondary: #656d76;
      --accent: #8957e5;
      --accent-hover: #7c3aed;
      --border: #d0d7de;
      --code-bg: #f6f8fa;
      --success: #2da44e;
      --error: #cf222e;
      --font-sans: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }

    @media (prefers-color-scheme: dark) {
      :root {
        --bg: #0d1117;
        --bg-secondary: #161b22;
        --text: #e6edf3;
        --text-secondary: #8b949e;
        --accent: #a371f7;
        --accent-hover: #8957e5;
        --border: #30363d;
        --code-bg: #161b22;
        --success: #3fb950;
        --error: #f85149;
      }
    }

    body {
      font-family: var(--font-sans);
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .container {
      text-align: center;
      padding: 2rem;
      max-width: 480px;
    }

    /* Spinner */
    .spinner {
      width: 48px;
      height: 48px;
      border: 4px solid var(--border);
      border-top-color: var(--accent);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
      margin: 0 auto 1.5rem;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .logo {
      font-size: 2rem;
      margin-bottom: 1.5rem;
    }

    .message {
      font-size: 1.1rem;
      color: var(--text-secondary);
      line-height: 1.6;
    }

    /* Error state */
    .error-state { display: none; }

    .error-state.visible {
      display: block;
      animation: fadeIn 0.3s ease;
    }

    .loading-state.hidden { display: none; }

    .error-icon {
      font-size: 3rem;
      margin-bottom: 1rem;
    }

    .error-title {
      font-size: 1.25rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
      color: var(--error);
    }

    .error-detail {
      font-size: 0.9rem;
      color: var(--text-secondary);
      margin-bottom: 1.5rem;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.75rem 1.5rem;
      background: var(--accent);
      color: white;
      text-decoration: none;
      border-radius: 8px;
      font-weight: 600;
      font-size: 1rem;
      transition: background 0.2s;
    }

    .btn:hover { background: var(--accent-hover); }

    /* Fallback buttons shown after download starts */
    .fallback-actions {
      display: none;
      margin-top: 2rem;
      animation: fadeIn 0.3s ease;
    }

    .fallback-actions.visible { display: block; }

    .fallback-hint {
      font-size: 0.85rem;
      color: var(--text-secondary);
      margin-bottom: 0.75rem;
    }

    .btn-row {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      align-items: center;
    }

    .btn-secondary {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.6rem 1.2rem;
      background: var(--bg-secondary);
      color: var(--text);
      text-decoration: none;
      border-radius: 8px;
      border: 1px solid var(--border);
      font-weight: 500;
      font-size: 0.9rem;
      transition: border-color 0.2s, background 0.2s;
    }

    .btn-secondary:hover {
      border-color: var(--accent);
      background: var(--code-bg);
    }

    .home-link {
      display: block;
      margin-top: 1.5rem;
      color: var(--text-secondary);
      text-decoration: none;
      font-size: 0.875rem;
    }

    .home-link:hover { color: var(--accent); }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    noscript p {
      font-size: 1.1rem;
      color: var(--text-secondary);
      line-height: 1.6;
    }

    noscript a {
      color: var(--accent);
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Loading state -->
    <div class="loading-state" id="loading">
      <div class="logo">üê±</div>
      <div class="spinner"></div>
      <p class="message" data-i18n="androidLoading">Detecting your device and downloading...</p>
      <!-- Fallback buttons shown after download redirect -->
      <div class="fallback-actions" id="fallback">
        <p class="fallback-hint" data-i18n="androidFallbackHint">Download didn't start? Try these options:</p>
        <div class="btn-row">
          <a class="btn" id="download-btn" href="#" data-i18n="androidDownloadApk">Download APK</a>
          <a class="btn-secondary" id="repo-link" href="#" data-i18n="androidViewRepo">View repository</a>
          <a class="btn-secondary" id="releases-fallback-link" href="#" data-i18n="androidViewReleases">View all releases</a>
        </div>
      </div>
    </div>

    <!-- Error state -->
    <div class="error-state" id="error">
      <div class="error-icon">üì¶</div>
      <p class="error-title" data-i18n="androidError">No Android app found for this project</p>
      <p class="error-detail" id="error-detail"></p>
      <a class="btn" id="releases-link" href="#" data-i18n="androidViewReleases">View all releases</a>
      <br>
      <a class="btn-secondary" id="repo-error-link" href="#" style="margin-top:0.75rem" data-i18n="androidViewRepo">View repository</a>
      <a class="home-link" href="/">üê± install.cat</a>
    </div>

    <noscript>
      <div class="logo">üê±</div>
      <p data-i18n="androidNoscript">JavaScript is required to detect your device and find the right APK. Please enable JavaScript or visit the repository directly.</p>
      <br>
      <a class="btn" href="/" data-i18n="androidNoscriptHome">Go to install.cat</a>
    </noscript>
  </div>

  <script>
    const translations = {
      en: { androidLoading: 'Detecting your device and downloading...', androidError: 'No Android app found for this project', androidViewReleases: 'View all releases', androidViewRepo: 'View repository', androidDownloadApk: 'Download APK', androidFallbackHint: "Download didn't start? Try these options:", androidNoscript: 'JavaScript is required to detect your device and find the right APK. Please enable JavaScript or visit the repository directly.', androidNoscriptHome: 'Go to install.cat' },
      pt: { androidLoading: 'Detectando seu dispositivo e baixando...', androidError: 'Nenhum app Android encontrado para este projeto', androidViewReleases: 'Ver todas as releases', androidViewRepo: 'Ver reposit√≥rio', androidDownloadApk: 'Baixar APK', androidFallbackHint: 'Download n√£o iniciou? Tente estas op√ß√µes:', androidNoscript: 'JavaScript √© necess√°rio para detectar seu dispositivo e encontrar o APK correto. Ative o JavaScript ou visite o reposit√≥rio diretamente.', androidNoscriptHome: 'Ir para install.cat' },
      ca: { androidLoading: 'Detectant el teu dispositiu i baixant...', androidError: "No s'ha trobat cap app Android per a aquest projecte", androidViewReleases: 'Veure totes les releases', androidViewRepo: 'Veure repositori', androidDownloadApk: "Descarregar APK", androidFallbackHint: "La desc√†rrega no ha comen√ßat? Prova aquestes opcions:", androidNoscript: "Cal JavaScript per detectar el teu dispositiu i trobar l'APK correcte. Activa JavaScript o visita el repositori directament.", androidNoscriptHome: 'Anar a install.cat' },
      ar: { androidLoading: 'ÿ¨ÿßÿ±Ÿä ÿßŸÉÿ™ÿ¥ÿßŸÅ ÿ¨Ÿáÿßÿ≤ŸÉ ŸàÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ...', androidError: 'ŸÑŸÖ Ÿäÿ™ŸÖ ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ ÿ™ÿ∑ÿ®ŸäŸÇ Android ŸÑŸáÿ∞ÿß ÿßŸÑŸÖÿ¥ÿ±Ÿàÿπ', androidViewReleases: 'ÿπÿ±ÿ∂ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ•ÿµÿØÿßÿ±ÿßÿ™', androidViewRepo: 'ÿπÿ±ÿ∂ ÿßŸÑŸÖÿ≥ÿ™ŸàÿØÿπ', androidDownloadApk: 'ÿ™ÿ≠ŸÖŸäŸÑ APK', androidFallbackHint: 'ŸÑŸÖ Ÿäÿ®ÿØÿ£ ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑÿü ÿ¨ÿ±ÿ® Ÿáÿ∞Ÿá ÿßŸÑÿÆŸäÿßÿ±ÿßÿ™:', androidNoscript: 'JavaScript ŸÖÿ∑ŸÑŸàÿ® ŸÑÿßŸÉÿ™ÿ¥ÿßŸÅ ÿ¨Ÿáÿßÿ≤ŸÉ ŸàÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ APK ÿßŸÑŸÖŸÜÿßÿ≥ÿ®. Ÿäÿ±ÿ¨Ÿâ ÿ™ŸÅÿπŸäŸÑ JavaScript ÿ£Ÿà ÿ≤Ÿäÿßÿ±ÿ© ÿßŸÑŸÖÿ≥ÿ™ŸàÿØÿπ ŸÖÿ®ÿßÿ¥ÿ±ÿ©.', androidNoscriptHome: 'ÿßŸÑÿ∞Ÿáÿßÿ® ÿ•ŸÑŸâ install.cat' },
      bn: { androidLoading: '‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡¶∂‡¶®‡¶æ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá ‡¶è‡¶¨‡¶Ç ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...', androidError: '‡¶è‡¶á ‡¶™‡ßç‡¶∞‡¶ï‡¶≤‡ßç‡¶™‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ï‡ßã‡¶®‡ßã Android ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø', androidViewReleases: '‡¶∏‡¶Æ‡¶∏‡ßç‡¶§ ‡¶∞‡¶ø‡¶≤‡¶ø‡¶ú ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®', androidViewRepo: '‡¶∞‡¶ø‡¶™‡ßã‡¶ú‡¶ø‡¶ü‡¶∞‡¶ø ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®', androidDownloadApk: 'APK ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®', androidFallbackHint: '‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶Ø‡¶º‡¶®‡¶ø? ‡¶è‡¶á ‡¶¨‡¶ø‡¶ï‡¶≤‡ßç‡¶™‡¶ó‡ßÅ‡¶≤‡¶ø ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®:', androidNoscript: '‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶°‡¶ø‡¶≠‡¶æ‡¶á‡¶∏ ‡¶∂‡¶®‡¶æ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡¶§‡ßá ‡¶è‡¶¨‡¶Ç ‡¶∏‡¶†‡¶ø‡¶ï APK ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßá ‡¶™‡ßá‡¶§‡ßá JavaScript ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶®‡•§ ‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá JavaScript ‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶¨‡¶æ ‡¶∏‡¶∞‡¶æ‡¶∏‡¶∞‡¶ø ‡¶∞‡¶ø‡¶™‡ßã‡¶ú‡¶ø‡¶ü‡¶∞‡¶ø ‡¶≠‡¶ø‡¶ú‡¶ø‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®‡•§', androidNoscriptHome: 'install.cat ‡¶è ‡¶Ø‡¶æ‡¶®' },
      de: { androidLoading: 'Ger√§t wird erkannt und Download l√§uft...', androidError: 'Keine Android-App f√ºr dieses Projekt gefunden', androidViewReleases: 'Alle Releases anzeigen', androidViewRepo: 'Repository ansehen', androidDownloadApk: 'APK herunterladen', androidFallbackHint: 'Download nicht gestartet? Versuche diese Optionen:', androidNoscript: 'JavaScript wird ben√∂tigt, um Ihr Ger√§t zu erkennen und die richtige APK zu finden. Bitte aktivieren Sie JavaScript oder besuchen Sie das Repository direkt.', androidNoscriptHome: 'Zu install.cat' },
      es: { androidLoading: 'Detectando tu dispositivo y descargando...', androidError: 'No se encontr√≥ app Android para este proyecto', androidViewReleases: 'Ver todas las releases', androidViewRepo: 'Ver repositorio', androidDownloadApk: 'Descargar APK', androidFallbackHint: '¬øNo se inici√≥ la descarga? Prueba estas opciones:', androidNoscript: 'Se requiere JavaScript para detectar tu dispositivo y encontrar el APK correcto. Activa JavaScript o visita el repositorio directamente.', androidNoscriptHome: 'Ir a install.cat' },
      fr: { androidLoading: 'D√©tection de votre appareil et t√©l√©chargement...', androidError: 'Aucune app Android trouv√©e pour ce projet', androidViewReleases: 'Voir toutes les releases', androidViewRepo: 'Voir le d√©p√¥t', androidDownloadApk: "T√©l√©charger l'APK", androidFallbackHint: "Le t√©l√©chargement n'a pas d√©marr√© ? Essayez ces options :", androidNoscript: "JavaScript est requis pour d√©tecter votre appareil et trouver le bon APK. Veuillez activer JavaScript ou visitez le d√©p√¥t directement.", androidNoscriptHome: 'Aller √† install.cat' },
      hi: { androidLoading: '‡§Ü‡§™‡§ï‡§æ ‡§°‡§ø‡§µ‡§æ‡§á‡§∏ ‡§™‡§π‡§ö‡§æ‡§®‡§æ ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•à ‡§î‡§∞ ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...', androidError: '‡§á‡§∏ ‡§™‡•ç‡§∞‡•ã‡§ú‡•á‡§ï‡•ç‡§ü ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•ã‡§à Android ‡§ê‡§™ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ', androidViewReleases: '‡§∏‡§≠‡•Ä ‡§∞‡§ø‡§≤‡•Ä‡§ú‡§º ‡§¶‡•á‡§ñ‡•á‡§Ç', androidViewRepo: '‡§∞‡§ø‡§™‡•â‡§ú‡§ø‡§ü‡§∞‡•Ä ‡§¶‡•á‡§ñ‡•á‡§Ç', androidDownloadApk: 'APK ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç', androidFallbackHint: '‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§∂‡•Å‡§∞‡•Ç ‡§®‡§π‡•Ä‡§Ç ‡§π‡•Å‡§Ü? ‡§Ø‡•á ‡§µ‡§ø‡§ï‡§≤‡•ç‡§™ ‡§Ü‡§ú‡§º‡§Æ‡§æ‡§è‡§Ç:', androidNoscript: '‡§Ü‡§™‡§ï‡•á ‡§°‡§ø‡§µ‡§æ‡§á‡§∏ ‡§ï‡•ã ‡§™‡§π‡§ö‡§æ‡§®‡§®‡•á ‡§î‡§∞ ‡§∏‡§π‡•Ä APK ‡§ñ‡•ã‡§ú‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è JavaScript ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§π‡•à‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ JavaScript ‡§∏‡§ï‡•ç‡§∑‡§Æ ‡§ï‡§∞‡•á‡§Ç ‡§Ø‡§æ ‡§∏‡•Ä‡§ß‡•á ‡§∞‡§ø‡§™‡•â‡§ú‡§ø‡§ü‡§∞‡•Ä ‡§™‡§∞ ‡§ú‡§æ‡§è‡§Ç‡•§', androidNoscriptHome: 'install.cat ‡§™‡§∞ ‡§ú‡§æ‡§è‡§Ç' },
      id: { androidLoading: 'Mendeteksi perangkat Anda dan mengunduh...', androidError: 'Tidak ditemukan app Android untuk proyek ini', androidViewReleases: 'Lihat semua rilis', androidViewRepo: 'Lihat repositori', androidDownloadApk: 'Unduh APK', androidFallbackHint: 'Unduhan tidak dimulai? Coba opsi ini:', androidNoscript: 'JavaScript diperlukan untuk mendeteksi perangkat Anda dan menemukan APK yang tepat. Silakan aktifkan JavaScript atau kunjungi repositori langsung.', androidNoscriptHome: 'Ke install.cat' },
      ja: { androidLoading: '„Éá„Éê„Ç§„Çπ„ÇíÊ§úÂá∫„Åó„Å¶„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ‰∏≠...', androidError: '„Åì„ÅÆ„Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÅÆAndroid„Ç¢„Éó„É™„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì', androidViewReleases: '„Åô„Åπ„Å¶„ÅÆ„É™„É™„Éº„Çπ„ÇíË¶ã„Çã', androidViewRepo: '„É™„Éù„Ç∏„Éà„É™„ÇíË¶ã„Çã', androidDownloadApk: 'APK„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ', androidFallbackHint: '„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„ÅåÂßã„Åæ„Çä„Åæ„Åõ„Çì„ÅãÔºü„Åì„Å°„Çâ„Çí„ÅäË©¶„Åó„Åè„Å†„Åï„ÅÑÔºö', androidNoscript: '„Éá„Éê„Ç§„Çπ„ÇíÊ§úÂá∫„ÅóÈÅ©Âàá„Å™APK„ÇíË¶ã„Å§„Åë„Çã„Å´„ÅØJavaScript„ÅåÂøÖË¶Å„Åß„Åô„ÄÇJavaScript„ÇíÊúâÂäπ„Å´„Åô„Çã„Åã„ÄÅ„É™„Éù„Ç∏„Éà„É™„ÇíÁõ¥Êé•„ÅîË¶ß„Åè„Å†„Åï„ÅÑ„ÄÇ', androidNoscriptHome: 'install.cat„Å∏' },
      ko: { androidLoading: 'Í∏∞Í∏∞Î•º Í∞êÏßÄÌïòÍ≥† Îã§Ïö¥Î°úÎìú Ï§ë...', androidError: 'Ïù¥ ÌîÑÎ°úÏ†ùÌä∏Ïùò Android Ïï±ÏùÑ Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§', androidViewReleases: 'Î™®Îì† Î¶¥Î¶¨Ïä§ Î≥¥Í∏∞', androidViewRepo: 'Ï†ÄÏû•ÏÜå Î≥¥Í∏∞', androidDownloadApk: 'APK Îã§Ïö¥Î°úÎìú', androidFallbackHint: 'Îã§Ïö¥Î°úÎìúÍ∞Ä ÏãúÏûëÎêòÏßÄ ÏïäÏïòÎÇòÏöî? Îã§Ïùå ÏòµÏÖòÏùÑ ÏãúÎèÑÌïòÏÑ∏Ïöî:', androidNoscript: 'Í∏∞Í∏∞Î•º Í∞êÏßÄÌïòÍ≥† Ïò¨Î∞îÎ•∏ APKÎ•º Ï∞æÏúºÎ†§Î©¥ JavaScriptÍ∞Ä ÌïÑÏöîÌï©ÎãàÎã§. JavaScriptÎ•º ÌôúÏÑ±ÌôîÌïòÍ±∞ÎÇò Ï†ÄÏû•ÏÜåÎ•º ÏßÅÏ†ë Î∞©Î¨∏ÌïòÏÑ∏Ïöî.', androidNoscriptHome: 'install.catÏúºÎ°ú' },
      mr: { androidLoading: '‡§§‡•Å‡§Æ‡§ö‡•á ‡§°‡§ø‡§µ‡•ç‡§π‡§æ‡§á‡§∏ ‡§ì‡§≥‡§ñ‡§§ ‡§Ü‡§π‡•á ‡§Ü‡§£‡§ø ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡§§ ‡§Ü‡§π‡•á...', androidError: '‡§Ø‡§æ ‡§™‡•ç‡§∞‡§ï‡§≤‡•ç‡§™‡§æ‡§∏‡§æ‡§†‡•Ä ‡§ï‡•ã‡§£‡§§‡•á‡§π‡•Ä Android ‡§Ö‡•Ö‡§™ ‡§∏‡§æ‡§™‡§°‡§≤‡•á ‡§®‡§æ‡§π‡•Ä', androidViewReleases: '‡§∏‡§∞‡•ç‡§µ ‡§∞‡§ø‡§≤‡•Ä‡§ù ‡§™‡§π‡§æ', androidViewRepo: '‡§∞‡§ø‡§™‡•â‡§ú‡§ø‡§ü‡§∞‡•Ä ‡§™‡§π‡§æ', androidDownloadApk: 'APK ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§ï‡§∞‡§æ', androidFallbackHint: '‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§∏‡•Å‡§∞‡•Ç ‡§ù‡§æ‡§≤‡•á ‡§®‡§æ‡§π‡•Ä? ‡§Ø‡§æ ‡§™‡§∞‡•ç‡§Ø‡§æ‡§Ø ‡§µ‡§æ‡§™‡§∞‡§æ:', androidNoscript: '‡§§‡•Å‡§Æ‡§ö‡•á ‡§°‡§ø‡§µ‡•ç‡§π‡§æ‡§á‡§∏ ‡§ì‡§≥‡§ñ‡§£‡•ç‡§Ø‡§æ‡§∏‡§æ‡§†‡•Ä ‡§Ü‡§£‡§ø ‡§Ø‡•ã‡§ó‡•ç‡§Ø APK ‡§∂‡•ã‡§ß‡§£‡•ç‡§Ø‡§æ‡§∏‡§æ‡§†‡•Ä JavaScript ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§Ü‡§π‡•á. ‡§ï‡•É‡§™‡§Ø‡§æ JavaScript ‡§∏‡§ï‡•ç‡§∑‡§Æ ‡§ï‡§∞‡§æ ‡§ï‡§ø‡§Ç‡§µ‡§æ ‡§•‡•á‡§ü ‡§∞‡§ø‡§™‡•â‡§ú‡§ø‡§ü‡§∞‡•Ä ‡§≠‡•á‡§ü ‡§¶‡•ç‡§Ø‡§æ.', androidNoscriptHome: 'install.cat ‡§µ‡§∞ ‡§ú‡§æ' },
      ru: { androidLoading: '–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∏ –∑–∞–≥—Ä—É–∑–∫–∞...', androidError: 'Android-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —ç—Ç–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ', androidViewReleases: '–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ —Ä–µ–ª–∏–∑—ã', androidViewRepo: '–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π', androidDownloadApk: '–°–∫–∞—á–∞—Ç—å APK', androidFallbackHint: '–ó–∞–≥—Ä—É–∑–∫–∞ –Ω–µ –Ω–∞—á–∞–ª–∞—Å—å? –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —ç—Ç–∏ –≤–∞—Ä–∏–∞–Ω—Ç—ã:', androidNoscript: '–î–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤–∞—à–µ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∏ –ø–æ–∏—Å–∫–∞ –Ω—É–∂–Ω–æ–≥–æ APK —Ç—Ä–µ–±—É–µ—Ç—Å—è JavaScript. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–∫–ª—é—á–∏—Ç–µ JavaScript –∏–ª–∏ –ø–æ—Å–µ—Ç–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞–ø—Ä—è–º—É—é.', androidNoscriptHome: '–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ install.cat' },
      sw: { androidLoading: 'Inatambua kifaa chako na kupakua...', androidError: 'Hakuna app ya Android iliyopatikana kwa mradi huu', androidViewReleases: 'Tazama matoleo yote', androidViewRepo: 'Tazama hazina', androidDownloadApk: 'Pakua APK', androidFallbackHint: 'Upakuaji haukuanza? Jaribu chaguo hizi:', androidNoscript: 'JavaScript inahitajika kutambua kifaa chako na kupata APK sahihi. Tafadhali washa JavaScript au tembelea hazina moja kwa moja.', androidNoscriptHome: 'Nenda install.cat' },
      ur: { androidLoading: 'ÿ¢Ÿæ ⁄©ÿß ÿ¢ŸÑ€Å Ÿæ€Å⁄ÜÿßŸÜÿß ÿ¨ÿß ÿ±€Åÿß €Å€í ÿßŸàÿ± ⁄àÿßÿ§ŸÜ ŸÑŸà⁄à €ÅŸà ÿ±€Åÿß €Å€í...', androidError: 'ÿßÿ≥ Ÿæÿ±Ÿàÿ¨€å⁄©Ÿπ ⁄©€í ŸÑ€å€í ⁄©Ÿàÿ¶€å Android ÿß€åŸæ ŸÜ€Å€å⁄∫ ŸÖŸÑ€å', androidViewReleases: 'ÿ™ŸÖÿßŸÖ ÿ±€åŸÑ€åÿ≤ÿ≤ ÿØ€å⁄©⁄æ€å⁄∫', androidViewRepo: 'ÿ∞ÿÆ€åÿ±€Å ÿØ€å⁄©⁄æ€å⁄∫', androidDownloadApk: 'APK ⁄àÿßÿ§ŸÜ ŸÑŸà⁄à ⁄©ÿ±€å⁄∫', androidFallbackHint: '⁄àÿßÿ§ŸÜ ŸÑŸà⁄à ÿ¥ÿ±Ÿàÿπ ŸÜ€Å€å⁄∫ €ÅŸàÿßÿü €å€Å ÿßÿÆÿ™€åÿßÿ±ÿßÿ™ ÿ¢ÿ≤ŸÖÿßÿ¶€å⁄∫:', androidNoscript: 'ÿ¢Ÿæ ⁄©€í ÿ¢ŸÑ€í ⁄©€å ÿ¥ŸÜÿßÿÆÿ™ ÿßŸàÿ± ÿµÿ≠€åÿ≠ APK ÿ™ŸÑÿßÿ¥ ⁄©ÿ±ŸÜ€í ⁄©€í ŸÑ€å€í JavaScript ÿ∂ÿ±Ÿàÿ±€å €Å€í€î ÿ®ÿ±ÿß€Å ⁄©ÿ±ŸÖ JavaScript ŸÅÿπÿßŸÑ ⁄©ÿ±€å⁄∫ €åÿß ÿ®ÿ±ÿß€Å ÿ±ÿßÿ≥ÿ™ ÿ∞ÿÆ€åÿ±€í Ÿæÿ± ÿ¨ÿßÿ¶€å⁄∫€î', androidNoscriptHome: 'install.cat Ÿæÿ± ÿ¨ÿßÿ¶€å⁄∫' },
      zh: { androidLoading: 'Ê≠£Âú®Ê£ÄÊµãÊÇ®ÁöÑËÆæÂ§áÂπ∂‰∏ãËΩΩ...', androidError: 'Êú™ÊâæÂà∞Ê≠§È°πÁõÆÁöÑ Android Â∫îÁî®', androidViewReleases: 'Êü•ÁúãÊâÄÊúâÁâàÊú¨', androidViewRepo: 'Êü•Áúã‰ªìÂ∫ì', androidDownloadApk: '‰∏ãËΩΩ APK', androidFallbackHint: '‰∏ãËΩΩÊú™ÂºÄÂßãÔºüËØïËØï‰ª•‰∏ãÈÄâÈ°πÔºö', androidNoscript: 'ÈúÄË¶Å JavaScript Êù•Ê£ÄÊµãÊÇ®ÁöÑËÆæÂ§áÂπ∂ÊâæÂà∞Ê≠£Á°ÆÁöÑ APK„ÄÇËØ∑ÂêØÁî® JavaScript ÊàñÁõ¥Êé•ËÆøÈóÆ‰ªìÂ∫ì„ÄÇ', androidNoscriptHome: 'ÂâçÂæÄ install.cat' }
    };

    function detectLanguage() {
      const lang = navigator.language || navigator.userLanguage || 'en';
      const shortLang = lang.split('-')[0].toLowerCase();
      const supported = ['ar', 'bn', 'ca', 'de', 'en', 'es', 'fr', 'hi', 'id', 'ja', 'ko', 'mr', 'pt', 'ru', 'sw', 'ur', 'zh'];
      return supported.includes(shortLang) ? shortLang : 'en';
    }

    function applyTranslations(lang) {
      const t = translations[lang] || translations.en;
      const isRTL = ['ar', 'ur'].includes(lang);
      document.documentElement.dir = isRTL ? 'rtl' : 'ltr';
      document.documentElement.lang = lang === 'pt' ? 'pt-BR' : lang;
      document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (t[key]) el.textContent = t[key];
      });
    }

    function showError(detail, repo) {
      document.getElementById('loading').classList.add('hidden');
      const errorEl = document.getElementById('error');
      errorEl.classList.add('visible');
      document.getElementById('error-detail').textContent = detail || '';
      if (repo) {
        document.getElementById('releases-link').href = `https://github.com/${repo}/releases`;
        document.getElementById('repo-error-link').href = `https://github.com/${repo}`;
      }
    }

    // Show fallback buttons after download redirect (in case it didn't work)
    function showFallback(apkUrl, repo) {
      document.getElementById('download-btn').href = apkUrl;
      document.getElementById('repo-link').href = `https://github.com/${repo}`;
      document.getElementById('releases-fallback-link').href = `https://github.com/${repo}/releases`;
      // Show fallback after a short delay so the user sees the spinner first
      setTimeout(() => {
        document.getElementById('fallback').classList.add('visible');
      }, 3000);
    }

    // Detect device architecture via User-Agent Client Hints API, fallback to arm64
    async function detectArch() {
      try {
        if (navigator.userAgentData) {
          const hints = await navigator.userAgentData.getHighEntropyValues(['architecture']);
          if (hints.architecture) return hints.architecture;
        }
      } catch (e) {
        // API unavailable or permission denied
      }
      return 'arm64';
    }

    // Find the best matching APK from release assets
    function findApk(assets, repo, arch) {
      const repoName = repo.split('/')[1];
      const apks = assets.filter(a => a.name.endsWith('.apk'));
      if (!apks.length) return null;

      // Priority 1: exact match {repo}-android-{arch}.apk
      const exact = apks.find(a => a.name === `${repoName}-android-${arch}.apk`);
      if (exact) return exact;

      // Priority 2: partial match *android*{arch}*.apk
      const archLower = arch.toLowerCase();
      const partialArch = apks.find(a => {
        const name = a.name.toLowerCase();
        return name.includes('android') && name.includes(archLower);
      });
      if (partialArch) return partialArch;

      // Priority 3: any Android APK *android*.apk
      const anyAndroid = apks.find(a => a.name.toLowerCase().includes('android'));
      if (anyAndroid) return anyAndroid;

      // Priority 4: any APK at all
      return apks[0];
    }

    async function main() {
      const lang = detectLanguage();
      applyTranslations(lang);

      // Read ?gh= parameter
      const params = new URLSearchParams(window.location.search);
      const repo = params.get('gh');

      if (!repo || !repo.match(/^[a-zA-Z0-9_.-]+\/[a-zA-Z0-9_.-]+$/)) {
        showError('Invalid or missing ?gh=user/repo parameter', null);
        return;
      }

      // Check if the repo has its own android.html (full override)
      try {
        const checkUrl = `https://raw.githubusercontent.com/${repo}/refs/heads/main/android.html`;
        const head = await fetch(checkUrl, { method: 'HEAD' });
        if (head.ok) {
          window.location.href = checkUrl;
          return;
        }
      } catch (e) {
        // 404 or network error, proceed with default flow
      }

      // Check if the repo has an android.txt (custom URL redirect)
      try {
        const txtUrl = `https://raw.githubusercontent.com/${repo}/refs/heads/main/android.txt`;
        const txtRes = await fetch(txtUrl);
        if (txtRes.ok) {
          const url = (await txtRes.text()).trim().split('\n')[0].trim();
          if (url) {
            window.location.href = url;
            return;
          }
        }
      } catch (e) {
        // 404 or network error, proceed with default flow
      }

      // Detect architecture and fetch release in parallel
      const [arch, releaseRes] = await Promise.all([
        detectArch(),
        fetch(`https://api.github.com/repos/${repo}/releases/latest`).catch(() => null)
      ]);

      // No releases or API error ‚Äî redirect to repo home
      if (!releaseRes || !releaseRes.ok) {
        window.location.href = `https://github.com/${repo}`;
        return;
      }

      const release = await releaseRes.json();
      const apk = findApk(release.assets || [], repo, arch);

      if (apk) {
        window.location.href = apk.browser_download_url;
        // Show fallback buttons in case the download redirect didn't work
        showFallback(apk.browser_download_url, repo);
      } else {
        // No APK in releases ‚Äî redirect to repo home
        window.location.href = `https://github.com/${repo}`;
      }
    }

    main();
  </script>
</body>
</html>
